{
  "info": {
    "name": "Realtime Voice API",
    "description": "OpenAI Realtime Voice Assistant API endpoints for SIH Mental Health Platform",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "Create Realtime Voice Session",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"Response has client_secret\", function () {",
              "    var jsonData = pm.response.json();",
              "    pm.expect(jsonData.success).to.eql(true);",
              "    pm.expect(jsonData.data).to.have.property('client_secret');",
              "});",
              "",
              "pm.test(\"Client secret is not empty\", function () {",
              "    var jsonData = pm.response.json();",
              "    pm.expect(jsonData.data.client_secret).to.not.be.empty;",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": ""
        },
        "url": {
          "raw": "{{baseUrl}}/api/student/realtime-session",
          "host": ["{{baseUrl}}"],
          "path": ["api", "student", "realtime-session"]
        },
        "description": "Creates an ephemeral session token for WebRTC voice connection.\n\n**Authentication Required**: Yes (Student role)\n\n**Response**:\n- `client_secret`: Ephemeral token for WebRTC connection\n- `expires_at`: Token expiration timestamp (optional)\n\n**Use Case**:\n1. Student clicks \"Voice Mode\" in chatbot\n2. Frontend calls this endpoint\n3. Backend returns ephemeral token\n4. Frontend uses token to establish WebRTC connection with OpenAI\n\n**Security**:\n- OpenAI API key never exposed to frontend\n- Token expires after ~60 seconds\n- Single-use token per session"
      },
      "response": [
        {
          "name": "Success - Session Created",
          "originalRequest": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": ""
            },
            "url": {
              "raw": "{{baseUrl}}/api/student/realtime-session",
              "host": ["{{baseUrl}}"],
              "path": ["api", "student", "realtime-session"]
            }
          },
          "status": "OK",
          "code": 200,
          "_postman_previewlanguage": "json",
          "header": [
            {
              "key": "Content-Type",
              "value": "application/json"
            }
          ],
          "cookie": [],
          "body": "{\n  \"success\": true,\n  \"message\": \"Voice session created successfully\",\n  \"timestamp\": \"2025-12-06T10:30:00.000Z\",\n  \"data\": {\n    \"client_secret\": \"eph_abc123xyz789...\",\n    \"expires_at\": \"2025-12-06T10:31:00.000Z\"\n  }\n}"
        },
        {
          "name": "Error - API Key Not Configured",
          "originalRequest": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": ""
            },
            "url": {
              "raw": "{{baseUrl}}/api/student/realtime-session",
              "host": ["{{baseUrl}}"],
              "path": ["api", "student", "realtime-session"]
            }
          },
          "status": "Service Unavailable",
          "code": 503,
          "_postman_previewlanguage": "json",
          "header": [
            {
              "key": "Content-Type",
              "value": "application/json"
            }
          ],
          "cookie": [],
          "body": "{\n  \"success\": false,\n  \"message\": \"Voice assistant feature is not configured. Please contact administrator.\",\n  \"timestamp\": \"2025-12-06T10:30:00.000Z\"\n}"
        },
        {
          "name": "Error - OpenAI API Error",
          "originalRequest": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": ""
            },
            "url": {
              "raw": "{{baseUrl}}/api/student/realtime-session",
              "host": ["{{baseUrl}}"],
              "path": ["api", "student", "realtime-session"]
            }
          },
          "status": "Bad Gateway",
          "code": 502,
          "_postman_previewlanguage": "json",
          "header": [
            {
              "key": "Content-Type",
              "value": "application/json"
            }
          ],
          "cookie": [],
          "body": "{\n  \"success\": false,\n  \"message\": \"Failed to create voice session. Please try again later.\",\n  \"timestamp\": \"2025-12-06T10:30:00.000Z\"\n}"
        },
        {
          "name": "Error - Unauthorized",
          "originalRequest": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": ""
            },
            "url": {
              "raw": "{{baseUrl}}/api/student/realtime-session",
              "host": ["{{baseUrl}}"],
              "path": ["api", "student", "realtime-session"]
            }
          },
          "status": "Unauthorized",
          "code": 401,
          "_postman_previewlanguage": "json",
          "header": [
            {
              "key": "Content-Type",
              "value": "application/json"
            }
          ],
          "cookie": [],
          "body": "{\n  \"success\": false,\n  \"message\": \"Authentication required\",\n  \"timestamp\": \"2025-12-06T10:30:00.000Z\"\n}"
        }
      ]
    }
  ],
  "auth": {
    "type": "noauth"
  },
  "event": [
    {
      "listen": "prerequest",
      "script": {
        "type": "text/javascript",
        "exec": [
          "// Authentication is handled via cookies",
          "// Make sure you've logged in first using Auth API"
        ]
      }
    }
  ],
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:5000",
      "type": "string"
    }
  ]
}
